<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Load Balancing | V2Ray Beginner&#39;s Guide</title>
    <meta name="description" content="Step-by-step guide for first-timers&#39; using V2Ray.">
    
    
    <link rel="preload" href="/assets/css/0.styles.7bc838ba.css" as="style"><link rel="preload" href="/assets/js/app.b0f56dc8.js" as="script"><link rel="preload" href="/assets/js/2.2b0139c3.js" as="script"><link rel="preload" href="/assets/js/67.97d73aed.js" as="script"><link rel="prefetch" href="/assets/js/10.4e2a494b.js"><link rel="prefetch" href="/assets/js/11.5c82b95e.js"><link rel="prefetch" href="/assets/js/12.387ec18f.js"><link rel="prefetch" href="/assets/js/13.eeb8c9dc.js"><link rel="prefetch" href="/assets/js/14.43e76f69.js"><link rel="prefetch" href="/assets/js/15.2b1f0b1c.js"><link rel="prefetch" href="/assets/js/16.36b7881f.js"><link rel="prefetch" href="/assets/js/17.2c18ccf1.js"><link rel="prefetch" href="/assets/js/18.574b4a0a.js"><link rel="prefetch" href="/assets/js/19.a6e3265f.js"><link rel="prefetch" href="/assets/js/20.06dc095c.js"><link rel="prefetch" href="/assets/js/21.3e9a536c.js"><link rel="prefetch" href="/assets/js/22.57d52d02.js"><link rel="prefetch" href="/assets/js/23.807b9f8f.js"><link rel="prefetch" href="/assets/js/24.20c45f32.js"><link rel="prefetch" href="/assets/js/25.40e83bab.js"><link rel="prefetch" href="/assets/js/26.7da7b4ff.js"><link rel="prefetch" href="/assets/js/27.dea934f2.js"><link rel="prefetch" href="/assets/js/28.95c22557.js"><link rel="prefetch" href="/assets/js/29.6503c13e.js"><link rel="prefetch" href="/assets/js/3.9c9eb57b.js"><link rel="prefetch" href="/assets/js/30.f2b953c8.js"><link rel="prefetch" href="/assets/js/31.685e383e.js"><link rel="prefetch" href="/assets/js/32.86f2dcc8.js"><link rel="prefetch" href="/assets/js/33.f527bd00.js"><link rel="prefetch" href="/assets/js/34.02543a20.js"><link rel="prefetch" href="/assets/js/35.be746ece.js"><link rel="prefetch" href="/assets/js/36.8c1f693e.js"><link rel="prefetch" href="/assets/js/37.e75e8131.js"><link rel="prefetch" href="/assets/js/38.c244480e.js"><link rel="prefetch" href="/assets/js/39.f97d3336.js"><link rel="prefetch" href="/assets/js/4.ee5d5b61.js"><link rel="prefetch" href="/assets/js/40.16f892cb.js"><link rel="prefetch" href="/assets/js/41.ec14978f.js"><link rel="prefetch" href="/assets/js/42.1951468f.js"><link rel="prefetch" href="/assets/js/43.2d83ea95.js"><link rel="prefetch" href="/assets/js/44.35c5c8f5.js"><link rel="prefetch" href="/assets/js/45.b93158f5.js"><link rel="prefetch" href="/assets/js/46.edb5a52f.js"><link rel="prefetch" href="/assets/js/47.c69d5ba0.js"><link rel="prefetch" href="/assets/js/48.4ace2e65.js"><link rel="prefetch" href="/assets/js/49.6fdac9fe.js"><link rel="prefetch" href="/assets/js/5.63481a39.js"><link rel="prefetch" href="/assets/js/50.040c45a3.js"><link rel="prefetch" href="/assets/js/51.daa7c719.js"><link rel="prefetch" href="/assets/js/52.4be6c2d8.js"><link rel="prefetch" href="/assets/js/53.9d2d7db5.js"><link rel="prefetch" href="/assets/js/54.dd6ce373.js"><link rel="prefetch" href="/assets/js/55.4d469822.js"><link rel="prefetch" href="/assets/js/56.a5c8dd87.js"><link rel="prefetch" href="/assets/js/57.c3fcfae1.js"><link rel="prefetch" href="/assets/js/58.c9cadf8d.js"><link rel="prefetch" href="/assets/js/59.48cebf4c.js"><link rel="prefetch" href="/assets/js/6.c9081704.js"><link rel="prefetch" href="/assets/js/60.b5d6bf9c.js"><link rel="prefetch" href="/assets/js/61.fd84e097.js"><link rel="prefetch" href="/assets/js/62.ba30e0d6.js"><link rel="prefetch" href="/assets/js/63.2261338d.js"><link rel="prefetch" href="/assets/js/64.633ea468.js"><link rel="prefetch" href="/assets/js/65.a8576e25.js"><link rel="prefetch" href="/assets/js/66.39c0634b.js"><link rel="prefetch" href="/assets/js/68.0ab2f7b8.js"><link rel="prefetch" href="/assets/js/69.1edd6b4a.js"><link rel="prefetch" href="/assets/js/7.aca3372c.js"><link rel="prefetch" href="/assets/js/70.ae2d9419.js"><link rel="prefetch" href="/assets/js/71.e11bed65.js"><link rel="prefetch" href="/assets/js/72.773f1bba.js"><link rel="prefetch" href="/assets/js/73.254828fa.js"><link rel="prefetch" href="/assets/js/74.63cb7e9c.js"><link rel="prefetch" href="/assets/js/75.e9276e9f.js"><link rel="prefetch" href="/assets/js/76.1b75cb22.js"><link rel="prefetch" href="/assets/js/77.5d015b3f.js"><link rel="prefetch" href="/assets/js/78.cc32b701.js"><link rel="prefetch" href="/assets/js/79.4c359b56.js"><link rel="prefetch" href="/assets/js/8.d6b35862.js"><link rel="prefetch" href="/assets/js/80.cfaf26be.js"><link rel="prefetch" href="/assets/js/81.89be03c2.js"><link rel="prefetch" href="/assets/js/82.bbecf567.js"><link rel="prefetch" href="/assets/js/83.4c5ccb48.js"><link rel="prefetch" href="/assets/js/84.2644e51b.js"><link rel="prefetch" href="/assets/js/85.116d94b4.js"><link rel="prefetch" href="/assets/js/86.1c5f70e5.js"><link rel="prefetch" href="/assets/js/87.c744dc51.js"><link rel="prefetch" href="/assets/js/88.f769075b.js"><link rel="prefetch" href="/assets/js/89.07f980f8.js"><link rel="prefetch" href="/assets/js/9.736352df.js"><link rel="prefetch" href="/assets/js/90.a3b72077.js"><link rel="prefetch" href="/assets/js/91.8f4f8023.js"><link rel="prefetch" href="/assets/js/92.d53a2783.js"><link rel="prefetch" href="/assets/js/93.248016bb.js"><link rel="prefetch" href="/assets/js/94.843e5459.js"><link rel="prefetch" href="/assets/js/95.695355ee.js"><link rel="prefetch" href="/assets/js/96.264cbe0d.js"><link rel="prefetch" href="/assets/js/97.a20f1e63.js"><link rel="prefetch" href="/assets/js/98.6422600b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7bc838ba.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/en_US/" class="home-link router-link-active"><!----> <span class="site-name">V2Ray Beginner's Guide</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://v2fly.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Official Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/app/balance.html" class="nav-link">zh-CN</a></li><li class="dropdown-item"><!----> <a href="/en_US/app/balance.html" class="nav-link router-link-exact-active router-link-active">en-US</a></li></ul></div></div> <a href="https://github.com/v2fly/v2ray-step-by-step" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://v2fly.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Official Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/app/balance.html" class="nav-link">zh-CN</a></li><li class="dropdown-item"><!----> <a href="/en_US/app/balance.html" class="nav-link router-link-exact-active router-link-active">en-US</a></li></ul></div></div> <a href="https://github.com/v2fly/v2ray-step-by-step" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Preface</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/en_US/" class="sidebar-link">Guide to V2Ray configuration</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/en_US/prep/prep" class="sidebar-heading clickable"><span>Before start</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/en_US/basics/basics" class="sidebar-heading clickable"><span>Basics</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/en_US/advanced/advanced" class="sidebar-heading clickable"><span>Advanced</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/en_US/app/app" class="sidebar-heading clickable open"><span>Practical</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/en_US/app/transparent_proxy.html" class="sidebar-link">Transparent Proxy</a></li><li><a href="/en_US/app/reverse.html" class="sidebar-link">Reverse Proxy I</a></li><li><a href="/en_US/app/reverse2.html" class="sidebar-link">Reverse Proxy II</a></li><li><a href="/en_US/app/parent.html" class="sidebar-link">Forward Proxy</a></li><li><a href="/en_US/app/balance.html" class="active sidebar-link">Load Balancing</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en_US/app/balance.html#load-balancing" class="sidebar-link">Load Balancing</a></li><li class="sidebar-sub-header"><a href="/en_US/app/balance.html#configuration-example" class="sidebar-link">Configuration Example</a></li><li class="sidebar-sub-header"><a href="/en_US/app/balance.html#mechanism" class="sidebar-link">Mechanism</a></li><li class="sidebar-sub-header"><a href="/en_US/app/balance.html#note" class="sidebar-link">Note</a></li></ul></li><li><a href="/en_US/app/docker-deploy-v2ray.html" class="sidebar-link">Deploying V2Ray by Docker</a></li><li><a href="/en_US/app/benchmark.html" class="sidebar-link">Benchmark</a></li><li><a href="/en_US/app/optimization.html" class="sidebar-link">Memory optimization</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/en_US/routing/routing" class="sidebar-heading clickable"><span>Routing</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="load-balancing"><a href="#load-balancing" aria-hidden="true" class="header-anchor">#</a> Load Balancing</h2> <p>Unlike Shadowsocks and other protocols, V2Ray supports multi-server load-balancing configurations. To be clear, load-balancing means the traffic is split up and sent to multiple servers, rather than let the client selecting the best server based on ping or speed and sending all traffic through the single server. The result is a lower resource cost on individual servers and a more spread out traffic balance among the servers. Here's my story as an example. Back in the days when V2Ray was less optimized and all I had was low-spec VPS's with plentiful bandwidth, whenever downloading full speed through a server, I could see CPU usage on the server staying above 80% constantly and sometimes reaching above 95%. I had to limit my download speed in case the VPS provider cancel my services. In contrast, with load-balancing configured on my client, the CPU usage of my servers would go 50% tops and I didn't have to limit my download speed anymore. More than 1 year later I've moved on from the low-spec servers, coupled with a more efficient V2Ray protocol, I found there's no need to load-balance for saving CPU time. However, as people still ask about it now and then, I'll still write all these down so you'll know load-balancing is still an option in case you need it.</p> <h2 id="configuration-example"><a href="#configuration-example" aria-hidden="true" class="header-anchor">#</a> Configuration Example</h2> <p>Configuring load-balancing is an easy job for the client. In the configuration file, simply list all the servers (that are already up and running) in the vnext section in the &quot;outbound&quot; rule. For example:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;inbounds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  ...
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;outbound&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;protocol&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vmess&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;vnext&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address_of_vps1&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token number">8232</span><span class="token punctuation">,</span>
            <span class="token property">&quot;users&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1ce383ea-13e9-4939-9b1d-20d67135969a&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;alterId&quot;</span><span class="token operator">:</span> <span class="token number">64</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address_of_vps2&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token number">4822</span><span class="token punctuation">,</span>
            <span class="token property">&quot;users&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bc172445-4b5e-49b2-a712-12c5295fd26b&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;alterId&quot;</span><span class="token operator">:</span> <span class="token number">64</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
          <span class="token comment">//list more servers if needed</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;streamSettings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      ...
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    ...
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="mechanism"><a href="#mechanism" aria-hidden="true" class="header-anchor">#</a> Mechanism</h2> <p>Load-balancing is implemented by polling the servers in order. When traffic comes through the tunnel, the first connection goes to the first server listed in &quot;vnext&quot; section, the next connection goes to the next server. After the last server was polled, the first server in the list would be up next, so on and so forth. It sounds stupidly simple and it works very well if you own multiple low-spec VPS's. Load-balancing reduces the chance of transmitting a significant amount of traffic to and from a specific IP address during an extended amount of time. Although I really doubt these are the characteristics the firewalls are looking for (given there's not enough samples), it's better than nothing I guess.</p> <h2 id="note"><a href="#note" aria-hidden="true" class="header-anchor">#</a> Note</h2> <p>Make sure values such as port, ID for each individual servers  in the &quot;vmess&quot; section match the ones in &quot;streamSettings&quot;.</p> <h4 id="updates"><a href="#updates" aria-hidden="true" class="header-anchor">#</a> Updates</h4> <ul><li>2018-01-03 Initial Version.</li> <li>2018-04-05 Update</li> <li>2019-01-13 v4.0+ Adaptation</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/27/2020, 2:38:01 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/en_US/app/parent.html" class="prev">Forward Proxy</a></span> <span class="next"><a href="/en_US/app/docker-deploy-v2ray.html">Deploying V2Ray by Docker</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b0f56dc8.js" defer></script><script src="/assets/js/2.2b0139c3.js" defer></script><script src="/assets/js/67.97d73aed.js" defer></script>
  </body>
</html>
